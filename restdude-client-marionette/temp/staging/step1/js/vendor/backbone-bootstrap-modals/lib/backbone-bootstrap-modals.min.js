/*!
  backbone-bootstrap-modals 0.1.3
  http://github.com/leafygreen/backbone-bootstrap-modals

  Licensed under the MIT license.
*/
!function(a,b){"function"==typeof define&&define.amd?define(["underscore","backbone"],function(c,d){return a.BackboneBootstrapModals=b(c,d)}):"object"==typeof exports?module.exports=b(require("underscore"),require("backbone")):a.BackboneBootstrapModals=b(a._,a.Backbone)}(this,function(a,b){"use strict";var c={};return c.BaseHeaderView=b.View.extend({className:"modal-header",initialize:function(a){var b=a||{};this.label=b.label||"",this.labelId=b.labelId||"myModalLabel",this.labelTagName=b.labelTagName||"h4",this.showClose=void 0!==b.showClose?b.showClose:!0},render:function(){var a,b=$("<"+this.labelTagName+">",{id:this.labelId,"class":"modal-title"}).text(this.label);return this.showClose&&(a=$("<button>",{type:"button","class":"close","data-dismiss":"modal","aria-hidden":"true"}).html("&times;")),this.$el.html([a,b]),this}}),c.BaseBodyView=b.View.extend({className:"modal-body",initialize:function(a){var b=a||{};this.text=b.text,this.textTagName=b.textTagName||"p"},render:function(){var b;return this.text&&(b=a.isArray(this.text)?a.map(this.text,a.bind(this.createTag,this)):this.createTag(this.text),this.$el.html(b)),this},createTag:function(a){var b=$("<"+this.textTagName+">").text(a);return b}}),c.BaseFooterView=b.View.extend({className:"modal-footer",initialize:function(a){var b=a||{};this.buttons=b.buttons||[]},render:function(){function b(b){var c=$("<button>",a.extend({id:b.id,"class":b.className},b.attributes)).text(b.value);return c}return this.$el.html(this.buttons.map(b)),this}}),c.BaseModal=b.View.extend({className:"modal",attributes:{tabindex:"-1",role:"dialog","aria-labelledby":"myModalLabel"},bootstrapModalEvents:{"show.bs.modal":"onShowBsModal","shown.bs.modal":"onShownBsModal","hide.bs.modal":"onHideBsModal","hidden.bs.modal":"onHiddenBsModal"},headerView:c.BaseHeaderView,bodyView:c.BaseBodyView,footerView:c.BaseFooterView,modalOptions:{backdrop:!0,keyboard:!0},modalProperties:["modalOptions","headerView","headerViewOptions","bodyView","bodyViewOptions","footerView","footerViewOptions"],constructor:function(c){var d=c||{};this.shown=!1,a.extend(this,a.pick(d,this.modalProperties)),b.View.prototype.constructor.apply(this,arguments)},render:function(){this.removeSubviews(),this.initializeSubviews(),this.$el.html(['<div class="modal-dialog">','<div class="modal-content">',"</div>","</div>"].join(""));var a=this.$el.find(".modal-content");return this.headerView&&a.append(this.headerViewInstance.render().$el),this.bodyView&&a.append(this.bodyViewInstance.render().$el),this.footerView&&a.append(this.footerViewInstance.render().$el),this.onRender&&this.onRender.call(this),this.shown||this.modalOptions.show===!1||this.$el.modal(this.modalOptions),this},initializeSubviews:function(){this.headerViewInstance=this.buildSubview(this.getHeaderView(),a.result(this,"headerViewOptions"),"modal-header"),this.bodyViewInstance=this.buildSubview(this.getBodyView(),a.result(this,"bodyViewOptions"),"modal-body"),this.footerViewInstance=this.buildSubview(this.getFooterView(),a.result(this,"footerViewOptions"),"modal-footer")},getHeaderView:function(){return this.headerView},getBodyView:function(){return this.bodyView},getFooterView:function(){return this.footerView},buildSubview:function(b,c,d){if(!b)throw new Error("view not specified");var e=a.extend({model:this.model,collection:this.collection},c);return b.prototype.className||e.className||(e.className=d),new b(e)},remove:function(){return this.removeSubviews(),b.View.prototype.remove.apply(this,arguments),this.onClose&&this.onClose.call(this),this},removeSubviews:function(){this.headerViewInstance&&this.removeSubview(this.headerViewInstance),this.bodyViewInstance&&this.removeSubview(this.bodyViewInstance),this.footerViewInstance&&this.removeSubview(this.footerViewInstance)},removeSubview:function(a){b.Marionette&&a.close?a.close.apply(a):a.remove&&a.remove.apply(a)},delegateEvents:function(c){var d=c||a.result(this,"events")||{};a.each(this.getAdditionalEventsToDelegate(),function(b){a.extend(d,b)}),b.View.prototype.delegateEvents.call(this,d)},getAdditionalEventsToDelegate:function(){return[this.bootstrapModalEvents]},show:function(){this.$el.modal("show")},hide:function(){this.$el.modal("hide")},onShowBsModal:function(){this.onShow&&this.onShow.call(this)},onShownBsModal:function(){this.shown=!0,this.onShown&&this.onShown.call(this)},onHideBsModal:function(){this.onHide&&this.onHide.call(this)},onHiddenBsModal:function(){this.shown=!1,this.remove(),this.onHidden&&this.onHidden.call(this)}}),c.ConfirmationModal=c.BaseModal.extend({confirmationEvents:{"click #confirmation-confirm-btn":"onClickConfirm","keypress .modal-body":"onKeyPress"},headerViewOptions:function(){return{label:a.result(this,"label"),labelId:a.result(this,"labelId"),labelTagName:a.result(this,"labelTagName"),showClose:a.result(this,"showClose")}},bodyViewOptions:function(){return{text:a.result(this,"text"),textTagName:a.result(this,"textTagName")}},footerViewOptions:function(){var b=[],c=a.result(this,"showCancel");return(void 0===c||c===!0)&&b.push({id:"confirmation-cancel-btn",className:"btn "+(a.result(this,"cancelClassName")||"btn-default"),value:a.result(this,"cancelText")||"Cancel",attributes:{"data-dismiss":"modal","aria-hidden":"true"}}),b.push({id:"confirmation-confirm-btn",className:"btn "+(a.result(this,"confirmClassName")||"btn-primary"),value:a.result(this,"confirmText")||"Confirm"}),{buttons:b}},confirmationProperties:["label","labelId","labelTagName","showClose","text","textTagName","confirmText","confirmClassName","cancelText","cancelClassName","showCancel","onConfirm"],initialize:function(b){var c=b||{};a.extend(this,a.pick(c,this.confirmationProperties))},getAdditionalEventsToDelegate:function(){var a=c.BaseModal.prototype.getAdditionalEventsToDelegate.call(this);return a.concat(this.confirmationEvents)},onKeyPress:function(a){13===a.which&&(a.preventDefault(),this.$("#confirmation-confirm-btn").click())},onClickConfirm:function(a){a.preventDefault(),a.currentTarget.disabled=!0,this.confirmProgress(a)},confirmProgress:function(a){this.onConfirm?this.onConfirm.call(this,a)!==!1&&this.hide():this.hide()}}),c.WizardModal=c.BaseModal.extend({wizardEvents:{"click #confirmation-previous-btn":"onClickPrevious","click #confirmation-next-btn":"onClickNext","keypress .modal-body":"onKeyPress"},getBodyView:function(){return this.currentStep.view},headerViewOptions:function(){return{label:this.currentStep.label}},bodyViewOptions:function(){return this.currentStep.viewOptions},footerViewOptions:function(){var a=this.getButtonsForCurrentStep();return{buttons:a}},initialize:function(a){this.initializeSteps(a),this.setCurrentStep(0)},initializeSteps:function(b){if(b.stepGraph&&(this.stepGraph=b.stepGraph),!this.stepGraph||!a.isArray(this.stepGraph)||!this.stepGraph.length)throw new Error("steps array must be specified and non-empty")},setCurrentStep:function(a){this.currentStep=this.stepGraph[a]},getButtonsForCurrentStep:function(){var a=this.currentStep.previousIndex,b=this.currentStep.previousText||"Previous",c=this.currentStep.previousClassName||"btn-default",d=(this.currentStep.nextIndex,this.currentStep.nextText||"Next"),e=this.currentStep.nextClassName||"btn-primary",f=[];return void 0!==a&&f.push({id:"confirmation-previous-btn",className:"btn "+c,value:b}),f.push({id:"confirmation-next-btn",className:"btn "+e,value:d}),f},getAdditionalEventsToDelegate:function(){var a=c.BaseModal.prototype.getAdditionalEventsToDelegate.call(this);return a.concat(this.wizardEvents)},renderPreviousStep:function(){this.setCurrentStep(this.currentStep.previousIndex),this.render()},renderNextStep:function(){var a=this.currentStep.nextIndex;void 0!==a?(this.setCurrentStep(a),this.render()):this.hide()},onClickPrevious:function(a){a.preventDefault(),a.currentTarget.disabled=!0,this.renderPreviousStep()},onKeyPress:function(a){13===a.which&&(a.preventDefault(),this.$("#confirmation-next-btn").click())},onClickNext:function(a){a.preventDefault(),a.currentTarget.disabled=!0,this.goForward(a)},goForward:function(a){this.currentStep.onNext&&this.currentStep.onNext.call(this,a)===!1||this.renderNextStep()}}),c});